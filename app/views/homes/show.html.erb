<div class="inventory">
  <% @home.items.sort.each do |item| %>
    <div class="item row">
      <div class="item-name"><%= item.name %></div>
      <div class="photo"><%= image_tag item.main_photo.photo.url(:small) %></div>
      <% item.pending_requests.each do |request| %>
        <li class="request">
          <span class="button"><input type="radio" name="request_id" value="<%= request.id %>"></span>
          <%= request.user.username %>
          <span class="start"><%= request.start_date.strftime('%A, %b %d: %l:%M %p') %></span>  
          <span class="end"><%= request.end_date.strftime('%A, %b %d: %l:%M %p') %></span> 
        </li>
      <% end %>
    </div>  
  <% end %>
</div>

<%= link_to "Create a new Item", new_item_url %>

<%= render partial: "homes/form" %>
<br>
<p>or type it out the long way</p>
<h6>this way currently doesn't work</h6>
<form action="<%= home_url(@home) %>" class="home edit">
  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <label for="home_street" class="">Street</label>
  <input type="text" name="home[street]" id="home_street" value="<%= @home.street %>">
  <label for="home_city" class="">City</label>
  <input type="text" name="home[city]" id="home_city" value="<%= @home.city %>">
  <label for="home_state" class="">State</label>
  <input type="text" name="home[state]" id="home_state" value="<%= @home.state %>">
  <label for="home_zipcode" class="">Zipcode</label>
  <input type="text" name="home[zipcode]" id="home_zipcode" value="<%= @home.zipcode %>">
  <input type="submit" value="update">
</form>

<!-- TODO: Risks code injection, move to a backbone AJAX request -->
<script id="bootstrapped-rentals">
$(document).ready(function() {
    var id = <%= @home.id %>
    var rentals = <%= @home_rentals.to_json.html_safe %>;
    var options = { 
      $rootEl: $('.inventory'),
      collection: rentals
    };
    LoanItToMe.initialize(options);
    // LoanItToMe.mainRouter.navigate("homes/" + id, {trigger: true })
  });
</script>


